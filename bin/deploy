#!/usr/bin/env sh

# Exit if any subcommand fails.
set -e

echo "Started deploying"

rm .asset-cache -dr

# Build site.
yarn install --modules-folder ./_assets/yarn
JEKYLL_ENV=production bundle exec jekyll build

if [ ! -d ../deploy/ ]; then
    mkdir ../deploy/
fi

mv --backup=numbered _site/* ../deploy/
rm -dr _site/
rm ../deploy/*.~1~ -dr

echo "Deployed Successfully!"

exit 0
